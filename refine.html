<!DOCTYPE html>
<html lang="ar" dir="rtl">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ุฃุซุฑ | ูููุญ ุงูููุชุฑุญุงุช ุงูุฐูู</title>
    <link
        href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;800&family=Cairo:wght@400;600;700;900&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <div class="bg-blobs">
        <div class="blob blob-1"></div>
        <div class="blob blob-3"></div>
    </div>

    <div class="container">
        <nav>
            <div class="logo-container">
                <a href="index.html" style="text-decoration:none; display:flex; align-items:center; gap:20px;">
                    <img src="ุชูุฒูู.jpg" alt="Logo" id="mainLogo">
                    <div>
                        <div class="logo">ุฃุซูููููุฑ</div>
                        <div class="logo-slogan">ูููุญ ุงูููุชุฑุญุงุช (Donor Compliance)</div>
                    </div>
                </a>
            </div>
            <a href="index.html" class="btn btn-ghost">๐ ุงูุฑุฆูุณุฉ</a>
        </nav>

        <main class="glass-card">
            <h1>โ๏ธ ุชูููุญ ูุชูููู ููุชุฑุญุงุช ุงููุดุงุฑูุน</h1>
            <p style="color: var(--text-secondary); margin-bottom: 30px;">
                ูู ุจูุตู ูุต ููุชุฑุญ ุงููุดุฑูุน ููุง. ุณูููู ุจุฏุฑู ุฎุจูุฑ ุงููุงูุญูู (UN/EU/USAID) ููุฑุงุฌุนุฉ ุงููุตูุตุ ุชุญุณูู ุงููุบุฉุ ุณุฏ
                ุงููุฌูุงุชุ ูุถูุงู ุงูุงูุชุซุงู ูููุนุงููุฑ.
            </p>

            <div class="form-group">
                <label>ูุต ููุชุฑุญ ุงููุดุฑูุน</label>
                <textarea id="proposalText" rows="15"
                    placeholder="ุฃูุตู ุงููุต ุงููุงูู ููููุชุฑุญ ููุง (ุงูุฎูููุฉุ ุงูุฃูุฏุงูุ ุงูุฃูุดุทุฉุ ุงููุชุงุฆุฌ...)..."></textarea>
            </div>

            <button id="refineBtn" class="btn btn-primary" style="width: 100%;">ุจุฏุก ุงูุชูููุญ ูุงููุฑุงุฌุนุฉ โก</button>

            <div id="refineResult"
                style="display: none; margin-top: 40px; border-top: 1px solid var(--glass-border); padding-top: 20px;">
                <h2 style="color: var(--primary);">ุงููุณุฎุฉ ุงููููุญุฉ ูุงูุชูุฑูุฑ</h2>
                <div id="refineOutput"
                    style="background: #fff; color: #333; padding: 30px; border-radius: 12px; min-height: 400px; white-space: pre-wrap; line-height: 1.6;">
                    <!-- Result here -->
                </div>
            </div>
        </main>
    </div>

    <script>
        const API_KEY = "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";

        document.getElementById('refineBtn').onclick = async () => {
            const text = document.getElementById('proposalText').value;
            if (!text) return alert("ุงูุฑุฌุงุก ูุตู ุงููุต ุฃููุงู");

            const btn = document.getElementById('refineBtn');
            btn.innerText = 'ุฌุงุฑู ุงููุฑุงุฌุนุฉ ูุงูุชูููุญ...';
            btn.disabled = true;

            const prompt = `
            ุงูุฏูุฑ: ุฎุจูุฑ ุฏููู ูู ูุชุงุจุฉ ููุฑุงุฌุนุฉ ููุชุฑุญุงุช ุงููุดุงุฑูุน (UN, EU, USAID).
            ุงููููุฉ: ุชุญููู ูุชูููุญ ุงููุต ุงูุชุงูู ููููู ุงุญุชุฑุงููุงู ููุชูุงููุงู ูุน ุงููุงูุญูู.
            
            ุงููุต ุงูุฃุตูู:
            ${text}

            ุงููุชุทูุจุงุช:
            1. ุชูููุญ ุงููุบุฉ ูุชููู ุฑุณููุฉ "ูุงูุญุฉ" (Donor Language).
            2. ุฅุนุงุฏุฉ ุตูุงุบุฉ ุงูููุฑุงุช ุงูุถุนููุฉ.
            3. ุงูุชุฑุงุญ ุฅุถุงูุงุช ุนูุฏ ูุฌูุฏ ูุฌูุงุช (ุญูุงูุฉุ ููุน ุงุฌุชูุงุนูุ ุงุณุชุฏุงูุฉ).
            4. ุงูุงูุชุฒุงู ุจููุฑุฉ ุงููุดุฑูุน ุงูุฃุณุงุณูุฉ ูุนุฏู ุฅุถุงูุฉ ููุฒุงููุฉ.
            
            ุงููุฎุฑุฌุงุช ุงููุทููุจุฉ:
            1. ุงููุณุฎุฉ ุงููููุญุฉ ุงููุงููุฉ (ูุน ุนูุงููู ูุงุถุญุฉ).
            2. ูุงุฆูุฉ ุงูุชุญุณููุงุช ุงูุชู ุชูุช.
            3. ููุงุญุธุงุช ูุชูุจููุงุช ููุงุท ุงูุถุนู.

            ุงูุฑุฏ: ูุต ููุณู (ูููู ุงุณุชุฎุฏุงู Markdown ููุนูุงููู).
            `;

            try {
                const res = await fetch("https://api.groq.com/openai/v1/chat/completions", {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json",
                        "Authorization": `Bearer ${API_KEY}`
                    },
                    body: JSON.stringify({
                        model: "llama-3.3-70b-versatile",
                        messages: [{ role: "user", content: prompt }]
                    })
                });

                const json = await res.json();
                if (json.choices) {
                    const content = json.choices[0].message.content;
                    document.getElementById('refineOutput').innerHTML = content
                        .replace(/\n\n/g, '<br><br>')
                        .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>');
                    document.getElementById('refineResult').style.display = 'block';
                }
            } catch (e) {
                alert("Error connecting to AI");
                console.error(e);
            }

            btn.innerText = 'ุจุฏุก ุงูุชูููุญ ูุงููุฑุงุฌุนุฉ โก';
            btn.disabled = false;
        };
    </script>
</body>

</html>