<!DOCTYPE html>
<html lang="ar" dir="rtl">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø§Ù„ÙˆØ¸Ø§Ø¦Ù Ø§Ù„Ø´Ø§ØºØ±Ø© | Ù…Ù†ØµØ© Ø£Ø«Ø±</title>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#6366f1">
    <script src="language_manager.js"></script>

    <style>
        .jobs-container {
            display: grid;
            grid-template-columns: 1fr 320px;
            gap: 30px;
        }

        .job-card {
            background: var(--glass-bg);
            backdrop-filter: blur(12px);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 20px;
            border: 1px solid var(--glass-border);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            color: var(--text-primary);
        }

        .job-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.08);
            border-color: var(--primary);
        }

        .job-badge {
            position: absolute;
            top: 25px;
            left: 25px;
            padding: 5px 15px;
            border-radius: 30px;
            font-size: 0.75rem;
            font-weight: 700;
        }

        .badge-high {
            background: #fef2f2;
            color: #ef4444;
            border: 1px solid #fee2e2;
        }

        .badge-normal {
            background: #f0fdf4;
            color: #10b981;
            border: 1px solid #dcfce7;
        }

        .job-header {
            display: flex;
            align-items: center;
            gap: 20px;
            margin-bottom: 20px;
        }

        .org-logo {
            width: 60px;
            height: 60px;
            background: var(--glass-bg);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            color: var(--primary);
        }

        .job-title {
            font-size: 1.3rem;
            font-weight: 800;
            color: var(--text-primary);
            margin-bottom: 5px;
        }

        .job-org {
            color: var(--primary);
            font-weight: 600;
            font-size: 0.95rem;
        }

        .job-meta {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            margin-bottom: 20px;
            font-size: 0.85rem;
            color: var(--text-secondary);
        }

        .meta-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .job-description {
            line-height: 1.8;
            color: var(--text-secondary);
            font-size: 0.95rem;
            margin-bottom: 20px;
            display: -webkit-box;
            -webkit-line-clamp: 3;
            line-clamp: 3;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .job-actions {
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-top: 1px solid #f1f5f9;
            padding-top: 20px;
        }

        .deadline-timer {
            font-size: 0.85rem;
            color: #ef4444;
            font-weight: 600;
        }

        /* Sidebar Stats */
        .stats-card {
            background: var(--glass-bg);
            backdrop-filter: blur(12px);
            border-radius: 20px;
            padding: 25px;
            border: 1px solid var(--glass-border);
            position: sticky;
            top: 20px;
            color: var(--text-primary);
        }

        .stat-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--glass-border);
        }

        .stat-item:last-child {
            border: none;
        }

        .job-alert-banner {
            background: linear-gradient(135deg, var(--primary), #1e40af);
            color: white;
            padding: 20px;
            border-radius: 16px;
            margin-bottom: 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        @media (max-width: 992px) {
            .jobs-container {
                grid-template-columns: 1fr;
            }

            .stats-card {
                display: none;
            }
        }
    </style>
</head>

<body class="light-theme">
    <div class="bg-blobs">
        <div class="blob blob-1"></div>
        <div class="blob blob-3"></div>
    </div>

    <div class="container">
        <nav>
            <div class="logo-container">
                <a href="index.html" style="text-decoration:none; display:flex; align-items:center; gap:20px;">
                    <img src="ØªÙ†Ø²ÙŠÙ„.jpg" alt="Logo" id="mainLogo">
                    <div>
                        <div class="logo">Ø£Ø«Ù€Ù€Ù€Ù€Ù€Ø±</div>
                        <div class="logo-slogan">Ø¨ÙˆØ§Ø¨Ø© Ø§Ù„ÙˆØ¸Ø§Ø¦Ù Ø§Ù„Ø¥Ù†Ø³Ø§Ù†ÙŠØ©</div>
                    </div>
                </a>
            </div>
            <div class="nav-actions">
                <a href="index.html" class="btn btn-ghost" data-i18n="nav_home">ğŸ  Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a>
                <div class="dropdown">
                    <button class="btn btn-ghost">ğŸ“‚ Ø®Ø¯Ù…Ø§Øª Ø§Ù„ØªÙˆØ¸ÙŠÙ</button>
                    <div class="dropdown-content">
                        <a href="career_path.html">ğŸš€ Ù…Ø³Ø§Ø±Ùƒ Ø§Ù„Ù…Ù‡Ù†ÙŠ</a>
                        <a href="job_prep.html">ğŸ¯ Ø§Ø³ØªØ¹Ø¯Ø§Ø¯ Ù„Ù„Ù…Ù‚Ø§Ø¨Ù„Ø§Øª</a>
                        <a href="skill_dev.html">ğŸ—ï¸ Ø¨Ù†Ø§Ø¡ Ø§Ù„Ù‚Ø¯Ø±Ø§Øª</a>
                        <a href="cv_improved.html">ğŸ¤– Ø³ÙŠØ±Ø© ATS Ø§Ù„Ø°ÙƒÙŠØ©</a>
                    </div>
                </div>
                <a href="refine_v3.html" class="btn btn-ghost" data-i18n="nav_refine">âš¡ Ø§Ù„Ù…Ù†Ù‚Ø­ Ø§Ù„Ø°ÙƒÙŠ</a>
                <a href="library_v3.html" class="btn btn-ghost" data-i18n="nav_lib">ğŸ“š Ø§Ù„Ù…ÙƒØªØ¨Ø©</a>
                <!-- <a href="whats_new.html" class="btn btn-ghost" data-i18n="nav_new">âœ¨ Ø§Ù„Ø¬Ø¯ÙŠØ¯</a> -->
                <button id="globalLangToggle" class="btn btn-ghost" onclick="LangManager.toggleLanguage()">English
                    ğŸ‡ºğŸ‡¸</button>
                <button id="themeToggle" class="btn btn-ghost">ğŸŒ“</button>
            </div>
        </nav>

        <main style="text-align: center; padding: 100px 20px;">
            <div class="glass-card" style="max-width: 600px; margin: auto; padding: 50px;">
                <div style="font-size: 5rem; margin-bottom: 20px;">â³</div>
                <h2 style="color: var(--primary); margin-bottom: 15px;">Ù‚Ø±ÙŠØ¨Ø§Ù‹... Ù…Ù†ØµØ© ÙØ±Øµ Ø§Ù„Ø¹Ù…Ù„</h2>
                <p style="font-size: 1.1rem; color: var(--text-secondary); line-height: 1.6;">
                    Ù†Ø­Ù† Ù†Ø¹Ù…Ù„ Ø­Ø§Ù„ÙŠØ§Ù‹ Ø¹Ù„Ù‰ ØªØ·ÙˆÙŠØ± Ù†Ø¸Ø§Ù… Ù…ØªÙ‚Ø¯Ù… Ù„Ø¬Ù„Ø¨ ÙˆØªØµÙ†ÙŠÙ Ø§Ù„ÙˆØ¸Ø§Ø¦Ù Ø§Ù„Ø´Ø§ØºØ±Ø© ÙÙŠ Ø§Ù„Ù‚Ø·Ø§Ø¹ Ø§Ù„Ø¥Ù†Ø³Ø§Ù†ÙŠ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø°ÙƒØ§Ø¡
                    Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ.
                    <br><br>
                    Ø³ÙŠØªÙ… ØªÙØ¹ÙŠÙ„ Ù‡Ø°Ù‡ Ø§Ù„Ø®Ø¯Ù…Ø© Ù‚Ø±ÙŠØ¨Ø§Ù‹ Ù„ØªÙƒÙˆÙ† Ø¨ÙˆØ§Ø¨ØªÙƒÙ… Ø§Ù„Ø£Ø³Ø±Ø¹ Ù„Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ø§Ù„ÙØ±Øµ Ø§Ù„Ù…ØªØ§Ø­Ø©.
                </p>
                <a href="index.html" class="btn btn-primary" style="margin-top: 30px; text-decoration: none;">Ø§Ù„Ø¹ÙˆØ¯Ø©
                    Ù„Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a>
            </div>
        </main>
    </div>

    <footer class="main-footer" style="margin-top: 50px;">
        <div class="footer-credit">
            <span>Ø¥Ø¹Ø¯Ø§Ø¯ ÙˆØªÙ†ÙÙŠØ° : </span>
            <span class="credit-name">Ø£. Ù†Ø¨ÙŠÙ„ Ø§Ù„Ø­Ù…ÙŠØ¯</span>
        </div>
        <div style="margin-top: 10px; opacity: 0.6; font-size: 0.8rem;">
            &copy; 2025 Ù…Ù†Ø¸ÙˆÙ…Ø© Ø£Ø«Ø± Ù„Ù„Ù…Ø´Ø§Ø±ÙŠØ¹ Ø§Ù„Ø¥Ù†Ø³Ø§Ù†ÙŠØ© - Ù…ØµØ¯Ø± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª: Jobs Bank Syria
        </div>
    </footer>

    <script>
        const GROQ_KEY = "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";
        const BRIDGE_DIRECT = "https://script.google.com/macros/s/AKfycbzCic7XWHobosbwc4PR7_zoS1aZqO6u2UO2-C5Sjm1Nrk7S_iKiCekYa-2Mz84tz-RC/exec";
        const BRIDGE_URL = BRIDGE_DIRECT;

        const telegramMessages = [
            "Ù…Ø·Ù„ÙˆØ¨ Ù…Ø¯ÙŠØ± Ù…Ø´Ø±ÙˆØ¹ Ù„Ù…Ù†Ø¸Ù…Ø© DRC ÙÙŠ Ù…Ø¯ÙŠÙ†Ø© Ø£Ø¹Ø²Ø§Ø². Ø§Ù„Ø®Ø¨Ø±Ø© 3 Ø³Ù†ÙˆØ§Øª. Ø§Ù„ØªÙ‚Ø¯ÙŠÙ… Ø¹Ø¨Ø± Ø§Ù„Ø±Ø§Ø¨Ø·: https://drc.ngo/jobs. Ø¢Ø®Ø± Ù…ÙˆØ¹Ø¯ 30 Ø¯ÙŠØ³Ù…Ø¨Ø±.",
            "ÙØ±ØµØ© Ø¹Ù…Ù„: Ù…Ø³Ø¤ÙˆÙ„ Ø­Ù…Ø§ÙŠØ© (PSEA) - Ù…Ù†Ø¸Ù…Ø© ØºØ±Ø§Ø³ Ø§Ù„Ù†Ù‡Ø¶Ø© - Ø¥Ø¯Ù„Ø¨. Ø¹Ù‚Ø¯ Ù„Ù…Ø¯Ø© 6 Ø£Ø´Ù‡Ø± Ù‚Ø§Ø¨Ù„ Ù„Ù„ØªÙ…Ø¯ÙŠØ¯. Ø§Ù„ØªÙˆØ§ØµÙ„ Ø¹Ø¨Ø± hrd@ghiras.org",
            "Vacancy: Finance Officer - International NGO - Damascus. Requirements: Accounting degree + 5 years exp. Deadline: 26 Dec!",
            "Ø§Ø³ØªØ´Ø§Ø±Ø© Ù‚ØµÙŠØ±Ø© Ø§Ù„Ø£Ù…Ø¯: Ù…Ø¯Ø±Ø¨ Ù…Ù‡Ø§Ø±Ø§Øª Ø­ÙŠØ§ØªÙŠØ© - Ù…Ù†Ø¸Ù…Ø© Ø¨Ù†ÙØ³Ø¬. Ø§Ù„ØªØ¯Ø±ÙŠØ¨ ÙÙŠ Ø¹ÙØ±ÙŠÙ†. Ø§Ù„Ø±Ø§Ø¨Ø·: violet.org/careers"
        ];

        async function processTelegramJobs() {
            const grid = document.getElementById('jobsGrid');
            const trigger = document.getElementById('syncTelegramBtn');
            trigger.innerText = "ğŸ”„ Ø¬Ø§Ø±ÙŠ Ø§Ù„Ù…Ø²Ø§Ù…Ù†Ø© Ù…Ø¹ ØªÙ„ØºØ±Ø§Ù… ÙˆØ¯Ø±Ø§ÙŠÙ...";

            if (BRIDGE_URL) {
                try {
                    // ÙØ±Ø²Ù‡ Ø§Ù„Ù…Ø²Ø§Ù…Ù†Ø© Ø£ÙˆÙ„Ø§Ù‹
                    await fetch(`${BRIDGE_URL}?action=sync`);

                    const response = await fetch(`${BRIDGE_URL}?type=jobs`);
                    const realJobs = await response.json();
                    if (realJobs && realJobs.length > 0) {
                        const activeJobs = filterExpiredJobs(realJobs.map(row => {
                            const description = row[5] || "";
                            return {
                                title: row[1], org: row[2], location: row[3], deadline: row[4],
                                summary: description, priority: "normal", type: "ÙˆØ¸ÙŠÙØ©", link: extractLink(description)
                            };
                        }));
                        renderJobs(activeJobs);
                        trigger.style.display = 'none';
                        document.getElementById('totalJobsCount').innerText = activeJobs.length;
                        return;
                    }
                } catch (e) { console.log("Bridge connection failed."); }
            }

            grid.innerHTML = '<p style="text-align:center">Ø¬Ø§Ø±ÙŠ ØªØ­Ù„ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ÙˆØ¸Ø§Ø¦Ù Ø§Ù„Ù…Ø³ØªÙ„Ù…Ø©...</p>';

            const prompt = `
            Ø£Ù†Øª Ø®Ø¨ÙŠØ± Ù…ÙˆØ§Ø±Ø¯ Ø¨Ø´Ø±ÙŠØ©. Ø­Ù„Ù„ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„ØªØ§Ù„ÙŠØ©: ${telegramMessages.join(' | ')}
            Ø§Ù„Ù…Ø·Ù„ÙˆØ¨: Ù…ØµÙÙˆÙØ© JSON Ø­ØµØ±Ø§Ù‹:
            [{
                "title": "Ø§Ù„Ù…Ø³Ù…Ù‰ Ø§Ù„ÙˆØ¸ÙŠÙÙŠ",
                "org": "Ø§Ù„Ø¬Ù‡Ø©",
                "location": "Ø§Ù„Ù…ÙˆÙ‚Ø¹",
                "deadline": "Ø§Ù„ØªØ§Ø±ÙŠØ® Ø¨ØµÙŠØºØ© YYYY-MM-DD",
                "link": "Ø±Ø§Ø¨Ø· Ø§Ù„ØªÙ‚Ø¯ÙŠÙ… Ø£Ùˆ Ø¥ÙŠÙ…ÙŠÙ„",
                "type": "ÙˆØ¸ÙŠÙØ©/Ø§Ø³ØªØ´Ø§Ø±Ø©",
                "priority": "high/normal",
                "summary": "ÙˆØµÙ Ù…Ø®ØªØµØ±"
            }]
            `;

            try {
                const res = await fetch("https://api.groq.com/openai/v1/chat/completions", {
                    method: "POST", headers: { "Content-Type": "application/json", "Authorization": `Bearer ${GROQ_KEY}` },
                    body: JSON.stringify({ model: "llama-3.3-70b-versatile", messages: [{ role: "user", content: prompt }], temperature: 0.3 })
                });
                const data = await res.json();
                const jobs = JSON.parse(data.choices[0].message.content.match(/\[[\s\S]*\]/)[0]);
                const activeJobs = filterExpiredJobs(jobs);
                renderJobs(activeJobs);
                trigger.style.display = 'none';
                document.getElementById('totalJobsCount').innerText = activeJobs.length;
            } catch (e) {
                grid.innerHTML = '<p style="color:red">ÙØ´Ù„ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ù†Ø¸Ø§Ù… Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø°ÙƒÙŠ.</p>';
            }
        }

        function filterExpiredJobs(jobs) {
            const now = new Date();
            // In a real app, compare job.deadline with now. 
            // For this version, we'll keep all but simulated expiration logic can be added here.
            return jobs.filter(job => {
                if (!job.deadline) return true;
                const dDate = new Date(job.deadline);
                if (isNaN(dDate.getTime())) return true; // Keep if date is text like "Tomorrow"
                return dDate >= now;
            });
        }

        function extractLink(text) {
            if (!text) return "#";
            // Check for explicit links/emails first
            const urlRegex = /(https?:\/\/[^\s]+)/g;
            const emailRegex = /([a-zA-Z0-9._-]+@[a-zA-Z0-9._-]+\.[a-zA-Z0-9_-]+)/g;
            const domainRegex = /([a-zA-Z0-9-]+\.(?:org|net|com|gov|edu|me|io)(?:\/[^\s]*)?)/g;

            const urlMatch = text.match(urlRegex);
            if (urlMatch) return urlMatch[0].replace(/[.,!?;:]$/, '');

            const emailMatch = text.match(emailRegex);
            if (emailMatch) return "mailto:" + emailMatch[0];

            const domainMatch = text.match(domainRegex);
            if (domainMatch) return "https://" + domainMatch[0].replace(/[.,!?;:]$/, '');

            return "#";
        }

        function renderJobs(jobs) {
            const grid = document.getElementById('jobsGrid');
            grid.innerHTML = '';
            jobs.forEach(job => {
                const card = document.createElement('div');
                card.className = 'job-card';
                const priorityBadge = job.priority === 'high' ? '<span class="job-badge badge-high">ğŸ”¥ Ù…Ù‡Ù… Ø¬Ø¯Ø§Ù‹</span>' : '<span class="job-badge badge-normal">ÙˆØ¸ÙŠÙØ© Ø¬Ø¯ÙŠØ¯Ø©</span>';

                card.innerHTML = `
                    ${priorityBadge}
                    <div class="job-header">
                        <div class="org-logo">${(job.org || '?')[0]}</div>
                        <div>
                            <div class="job-title">${job.title}</div>
                            <div class="job-org">${job.org}</div>
                        </div>
                    </div>
                    <div class="job-meta">
                        <div class="meta-item">ğŸ“ ${job.location}</div>
                        <div class="meta-item">ğŸ’¼ ${job.type}</div>
                        <div class="meta-item">ğŸ“… ${job.deadline}</div>
                    </div>
                    <div class="job-description">${job.summary || job.text || ''}</div>
                    <div class="job-actions">
                        <div class="deadline-timer">â³ ÙŠÙ†ØªÙ‡ÙŠ ÙÙŠ: ${job.deadline}</div>
                        <a href="${job.link || '#'}" target="_blank" class="btn btn-primary" style="padding: 8px 20px; font-size: 0.9rem; text-decoration:none;">Ø¹Ø±Ø¶ ÙˆØªÙˆØ§ØµÙ„</a>
                    </div>
                `;
                grid.appendChild(card);
            });
        }

        // Alert Activation
        document.getElementById('activateAlerts').onclick = function () {
            this.innerText = "âœ… Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªÙØ¹ÙŠÙ„...";
            setTimeout(() => {
                alert("ØªÙ… ØªÙØ¹ÙŠÙ„ Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª Ø§Ù„Ø°ÙƒÙŠØ©! Ø³ØªØµÙ„Ùƒ Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ø¨Ø§Ù„ÙˆØ¸Ø§Ø¦Ù Ø¹Ø§Ù„ÙŠØ© Ø§Ù„Ø£Ù‡Ù…ÙŠØ©.");
                this.innerText = "Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª Ù…ÙØ¹Ù„Ø©";
                this.style.background = "#10b981";
                this.disabled = true;
            }, 1000);
        };

        // Theme Toggle Fix
        const themeToggle = document.getElementById('themeToggle');
        themeToggle.onclick = () => {
            const isDark = document.body.classList.toggle('dark-theme');
            document.body.classList.toggle('light-theme', !isDark);
            localStorage.setItem('theme', isDark ? 'dark' : 'light');
        };

        // Load saved theme
        if (localStorage.getItem('theme') === 'dark') {
            document.body.classList.replace('light-theme', 'dark-theme');
        }

        document.getElementById('syncTelegramBtn').onclick = () => {
            processTelegramJobs();
        };

        // Initialize
        processTelegramJobs();
    </script>
</body>

</html>