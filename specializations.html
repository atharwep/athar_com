<!DOCTYPE html>
<html lang="ar" dir="rtl">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø£Ø«Ø± | Ø§Ù„ØªØ®ØµØµØ§Øª ÙˆØ§Ù„Ù…Ø³Ø§Ø±Ø§Øª Ø§Ù„Ø¥Ù†Ø³Ø§Ù†ÙŠØ©</title>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    <script src="protection.js"></script>
    <style>
        .page-container {
            max-width: 900px;
            margin: 40px auto;
            padding: 20px;
        }

        .input-card {
            background: var(--glass-bg);
            padding: 30px;
            border-radius: 20px;
            border: 1px solid var(--glass-border);
            margin-bottom: 30px;
        }

        textarea,
        input,
        select {
            width: 100%;
            padding: 12px;
            border-radius: 10px;
            border: 1px solid var(--glass-border);
            background: rgba(255, 255, 255, 0.05);
            color: var(--text-primary);
            margin-bottom: 15px;
            font-family: 'Cairo';
        }

        .btn-full {
            width: 100%;
            padding: 15px;
            font-size: 1.1rem;
            font-weight: bold;
            border-radius: 10px;
            cursor: pointer;
            border: none;
            background: #0369a1;
            color: white;
            transition: 0.3s;
        }

        .result-card {
            background: white;
            color: #333;
            padding: 30px;
            border-radius: 15px;
            display: none;
            line-height: 1.8;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }

        .path-step {
            display: flex;
            align-items: flex-start;
            gap: 15px;
            margin-bottom: 15px;
            padding: 10px;
            border-bottom: 1px solid #eee;
        }

        .step-num {
            background: #0369a1;
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            font-weight: bold;
        }
    </style>
</head>

<body class="light-theme">
    <nav>
        <div class="logo-container">
            <a href="index.html" style="text-decoration:none; display:flex; align-items:center; gap:10px;">
                <img src="ØªÙ†Ø²ÙŠÙ„.jpg" alt="Logo" style="width:40px; border-radius:5px;">
                <div class="logo">Ø£Ø«Ù€Ù€Ù€Ù€Ù€Ø±</div>
            </a>
        </div>
    </nav>

    <div class="page-container">
        <header style="text-align:center; margin-bottom:40px;">
            <h1 style="font-weight:900; color:#0369a1; font-size: 2.5rem;">ğŸŒ Ø§Ù„ØªØ®ØµØµØ§Øª ÙˆØ§Ù„Ù…Ø³Ø§Ø±Ø§Øª Ø§Ù„ÙˆØ¸ÙŠÙÙŠØ©</h1>
            <p style="color:var(--text-secondary);">Ø§Ø®ØªØ± ØªØ®ØµØµÙƒ Ø§Ù„Ø¥Ù†Ø³Ø§Ù†ÙŠ Ø¨Ø¯Ù‚Ø© ÙˆØ§Ø¨Ù†Ù Ù…Ø³Ø§Ø±Ø§Ù‹ ÙˆØ¸ÙŠÙÙŠØ§Ù‹ Ù…Ø³ØªØ¯Ø§Ù…Ø§Ù‹.</p>
        </header>

        <div class="input-card">
            <div class="form-group">
                <label>Ø®Ù„ÙÙŠØªÙƒ Ø§Ù„Ø£ÙƒØ§Ø¯ÙŠÙ…ÙŠØ© ÙˆÙ…Ù‡Ø§Ø±Ø§ØªÙƒ Ø§Ù„Ø­Ø§Ù„ÙŠØ©:</label>
                <textarea id="userBg" rows="4" placeholder="Ù…Ø«Ø§Ù„: Ù‡Ù†Ø¯Ø³Ø©ØŒ Ø­Ù‚ÙˆÙ‚ØŒ Ù„ØºØ© Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©ØŒ Ø®Ø¨Ø±Ø© Ø¥Ø¯Ø§Ø±ÙŠØ©..."></textarea>
            </div>
            <div class="form-group">
                <label>Ù…Ø§ Ù‡ÙŠ Ø§Ù‡ØªÙ…Ø§Ù…Ø§ØªÙƒ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© ÙÙŠ Ø§Ù„Ø¹Ù…Ù„ Ø§Ù„Ø¥Ù†Ø³Ø§Ù†ÙŠØŸ</label>
                <textarea id="interests" rows="2"
                    placeholder="Ù…Ø«Ø§Ù„: Ù…Ø³Ø§Ø¹Ø¯Ø© Ø§Ù„Ø£Ø·ÙØ§Ù„ØŒ Ø§Ù„Ø¨Ù†Ø§Ø¡ØŒ Ø§Ù„ØªØ®Ø·ÙŠØ·ØŒ Ø§Ù„ØªØ¹Ù„ÙŠÙ…..."></textarea>
            </div>
            <button id="findPathBtn" class="btn-full">ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…Ø³Ø§Ø± ÙˆØ§Ù„ÙˆØ¸ÙŠÙØ© âš¡</button>
        </div>

        <div id="statusLog" style="text-align:center; margin-bottom:20px; font-weight:bold;"></div>

        <div id="resultArea" class="result-card">
            <div id="pathContent"></div>
            <button id="exportBtn" class="btn btn-ghost" style="margin-top:20px; width:100%; border:1px solid #ddd;">ğŸ“¥
                ØªØ­Ù…ÙŠÙ„ Ø®Ø±ÙŠØ·Ø© Ø§Ù„Ù…Ø³Ø§Ø±</button>
        </div>
    </div>

    <script>
        const BRIDGE_URL = "https://script.google.com/macros/s/AKfycbzCic7XWHobosbwc4PR7_zoS1aZqO6u2UO2-C5Sjm1Nrk7S_iKiCekYa-2Mz84tz-RC/exec";

        document.getElementById('findPathBtn').onclick = async () => {
            const bg = document.getElementById('userBg').value;
            const interests = document.getElementById('interests').value;

            const btn = document.getElementById('findPathBtn');
            const status = document.getElementById('statusLog');
            btn.disabled = true;
            status.innerText = "â³ Ø¬Ø§Ø±ÙŠ Ø§Ø³ØªÙƒØ´Ø§Ù Ø§Ù„ØªØ®ØµØµØ§Øª Ø§Ù„Ù…Ù†Ø§Ø³Ø¨Ø© Ù„Ù…Ù„ÙÙƒ...";

            const prompt = `
            Ø£Ù†Øª Ù…Ø³ØªØ´Ø§Ø± Ù…Ø³Ø§Ø±Ø§Øª Ù…Ù‡Ù†ÙŠØ© ÙÙŠ Ø§Ù„Ù…Ù†Ø¸Ù…Ø§Øª.
            Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª: Ø§Ù„Ø®Ù„ÙÙŠØ© ${bg}, Ø§Ù„Ø§Ù‡ØªÙ…Ø§Ù…Ø§Øª ${interests}.
            
            Ø§Ù„Ù…Ø·Ù„ÙˆØ¨ (JSON Ø­ØµØ±Ø§Ù‹):
            {
                "suggested_specialization": "Ø§Ù„ØªØ®ØµØµ Ø§Ù„Ø£Ù†Ø³Ø¨",
                "description": "Ù„Ù…Ø§Ø°Ø§ Ù‡Ø°Ø§ Ø§Ù„ØªØ®ØµØµØŸ ÙˆÙƒÙŠÙ ÙŠØ¹Ù…Ù„ØŸ",
                "career_ladder": [
                    {"level": "Entry", "role": "ÙˆØ¸ÙŠÙØ© Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©"},
                    {"level": "Mid", "role": "ÙˆØ¸ÙŠÙØ© Ø§Ù„ÙˆØ³Ø·"},
                    {"level": "Expert", "role": "ÙˆØ¸ÙŠÙØ© Ø§Ù„Ù‚ÙŠØ§Ø¯Ø©"}
                ],
                "required_skills": ["Ù…Ù‡Ø§Ø±Ø© 1", "Ù…Ù‡Ø§Ø±Ø© 2"],
                "opportunities": "ÙØ±Øµ Ø§Ù„Ù†Ù…Ùˆ ÙˆØ§Ù„ØªØ±Ù‚ÙŠØ©",
                "horizontal_moves": "ÙˆØ¸Ø§Ø¦Ù Ø£Ø®Ø±Ù‰ Ù‚Ø±ÙŠØ¨Ø© ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø¥Ù„ÙŠÙ‡Ø§",
                "warnings": "ØªØ®ØµØµØ§Øª Ù„Ø§ ØªÙ†Ø§Ø³Ø¨Ùƒ Ø¨Ù†Ø§Ø¡ Ø¹Ù„Ù‰ Ø®Ù„ÙÙŠØªÙƒ"
            }
            Ø¨Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©.
            `;

            try {
                const res = await fetch(BRIDGE_URL + "?action=ai", {
                    method: "POST",
                    headers: { "Content-Type": "text/plain;charset=utf-8" },
                    body: JSON.stringify({
                        model: "llama-3.3-70b-versatile",
                        messages: [{ role: "user", content: prompt }],
                        temperature: 0.7
                    })
                });

                const dataText = await res.text();
                const json = JSON.parse(dataText.match(/\{[\s\S]*\}/)[0]);

                let html = `
                    <div style="background:#f0f9ff; padding:20px; border-radius:15px; border-right:5px solid #0369a1;">
                        <h2 style="color:#0369a1; margin:0;">Ø§Ù„ØªØ®ØµØµ Ø§Ù„Ù…Ù‚ØªØ±Ø­: ${json.suggested_specialization}</h2>
                        <p style="margin-top:10px;">${json.description}</p>
                    </div>

                    <h3 style="color:var(--primary); margin-top:25px; border-bottom:1px solid #ddd; padding-bottom:5px;">ğŸªœ Ø§Ù„Ø³Ù„Ù… Ø§Ù„ÙˆØ¸ÙŠÙÙŠ (Career Ladder)</h3>
                    ${json.career_ladder.map((step, i) => `
                        <div class="path-step">
                            <div class="step-num">${i + 1}</div>
                            <div>
                                <strong>[${step.level}]</strong> ${step.role}
                            </div>
                        </div>
                    `).join('')}

                    <div style="margin-top:20px;">
                        <h3 style="color:var(--primary);">ğŸ¯ Ø§Ù„Ù…Ù‡Ø§Ø±Ø§Øª Ø§Ù„ØªÙŠ ÙŠØ¬Ø¨ Ø£Ù† ØªØ¨Ù†ÙŠÙ‡Ø§</h3>
                        <ul>${json.required_skills.map(s => `<li>${s}</li>`).join('')}</ul>
                    </div>

                    <p><strong>ğŸš€ ÙØ±Øµ Ø§Ù„ØªØ±Ù‚ÙŠØ©:</strong> ${json.opportunities}</p>
                    <p><strong>â†”ï¸ Ø®ÙŠØ§Ø±Ø§Øª Ø¬Ø§Ù†Ø¨ÙŠØ©:</strong> ${json.horizontal_moves}</p>
                    
                    <div style="background:#fff1f2; padding:15px; border-radius:10px; border-right:5px solid #e11d48; margin-top:20px;">
                        <strong>âš ï¸ ØªØ®ØµØµØ§Øª Ù‚Ø¯ Ù„Ø§ ØªÙ†Ø§Ø³Ø¨Ùƒ:</strong> ${json.warnings}
                    </div>
                `;

                document.getElementById('pathContent').innerHTML = html;
                document.getElementById('resultArea').style.display = 'block';
                status.innerText = "âœ… Ø§ÙƒØªÙ…Ù„ ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…Ø³Ø§Ø±!";
            } catch (e) {
                console.error(e);
                status.innerText = "âŒ Ø­Ø¯Ø« Ø®Ø·Ø£.";
            } finally {
                btn.disabled = false;
            }
        };
        document.getElementById('exportBtn').onclick = () => {
            ProtectionManager.verify(() => window.print());
        };
    </script>
</body>

</html>