<!DOCTYPE html>
<html lang="ar" dir="rtl">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø£Ø«Ø± | Ø§Ù„Ø§Ø³ØªØ¯Ø§Ù…Ø© ÙˆØ§Ù„ÙˆÙ‚Ø§ÙŠØ© Ù…Ù† Ø§Ù„Ø§Ø­ØªØ±Ø§Ù‚</title>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    <script src="protection.js"></script>
    <style>
        .page-container {
            max-width: 900px;
            margin: 40px auto;
            padding: 20px;
        }

        .input-card {
            background: var(--glass-bg);
            padding: 30px;
            border-radius: 20px;
            border: 1px solid var(--glass-border);
            margin-bottom: 30px;
        }

        textarea,
        input,
        select {
            width: 100%;
            padding: 12px;
            border-radius: 10px;
            border: 1px solid var(--glass-border);
            background: rgba(255, 255, 255, 0.05);
            color: var(--text-primary);
            margin-bottom: 15px;
            font-family: 'Cairo';
        }

        .btn-full {
            width: 100%;
            padding: 15px;
            font-size: 1.1rem;
            font-weight: bold;
            border-radius: 10px;
            cursor: pointer;
            border: none;
            background: #10b981;
            color: white;
            transition: 0.3s;
        }

        .result-card {
            background: white;
            color: #333;
            padding: 30px;
            border-radius: 15px;
            display: none;
            line-height: 1.8;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }

        .burnout-indicator {
            background: #f0fdf4;
            border-right: 5px solid #10b981;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 20px;
            text-align: center;
        }
    </style>
</head>

<body class="light-theme">
    <nav>
        <div class="logo-container">
            <a href="index.html" style="text-decoration:none; display:flex; align-items:center; gap:10px;">
                <img src="ØªÙ†Ø²ÙŠÙ„.jpg" alt="Logo" style="width:40px; border-radius:5px;">
                <div class="logo">Ø£Ø«Ù€Ù€Ù€Ù€Ù€Ø±</div>
            </a>
        </div>
    </nav>

    <div class="page-container">
        <header style="text-align:center; margin-bottom:40px;">
            <h1 style="font-weight:900; color:#10b981; font-size: 2.5rem;">ğŸ§˜ Ø§Ù„Ø§Ø³ØªØ¯Ø§Ù…Ø© Ø§Ù„Ù…Ù‡Ù†ÙŠØ© ÙˆØ§Ù„ÙˆÙ‚Ø§ÙŠØ©</h1>
            <p style="color:var(--text-secondary);">Ø§Ø­Ù…Ù Ù†ÙØ³Ùƒ Ù…Ù† Ø§Ù„Ø§Ø­ØªØ±Ø§Ù‚ Ø§Ù„Ù…Ù‡Ù†ÙŠ ÙˆØ¨Ù†Ù Ù…Ø³Ø§Ø±Ø§Ù‹ Ù…Ø³ØªØ¯Ø§Ù…Ø§Ù‹ ÙÙŠ Ø§Ù„Ø¹Ù…Ù„ Ø§Ù„Ø¥Ù†Ø³Ø§Ù†ÙŠ
                Ø§Ù„Ø¶Ø§ØºØ·.</p>
        </header>

        <div class="input-card">
            <div class="form-group">
                <label>Ø·Ø¨ÙŠØ¹Ø© Ø¹Ù…Ù„Ùƒ Ø§Ù„Ø­Ø§Ù„ÙŠ (Ø£Ùˆ Ø§Ù„ÙˆØ¸ÙŠÙØ© Ø§Ù„ØªÙŠ ØªØªÙ‚Ø¯Ù… Ù„Ù‡Ø§):</label>
                <input type="text" id="jobNature" placeholder="Ù…Ø«Ø§Ù„: Ù…Ù†Ø³Ù‚ Ø§Ø³ØªØ¬Ø§Ø¨Ø© Ø·ÙˆØ§Ø±Ø¦ØŒ Ø­Ù…Ø§ÙŠØ© Ø·ÙÙˆÙ„Ø©ØŒ Ù…Ø­Ø§Ø³Ø¨...">
            </div>
            <div class="form-group">
                <label>Ø¨ÙŠØ¦Ø© Ø§Ù„Ø¹Ù…Ù„ ÙˆÙƒØ«Ø§ÙØ© Ø§Ù„Ø¶ØºÙˆØ·:</label>
                <textarea id="workEnv" rows="3"
                    placeholder="Ù…Ø«Ø§Ù„: Ø¹Ù…Ù„ Ù…ÙŠØ¯Ø§Ù†ÙŠ 12 Ø³Ø§Ø¹Ø©ØŒ Ø¶ØºØ· Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù…Ø§Ù†Ø­ÙŠÙ†ØŒ Ø§Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ø­Ø§Ù„Ø§Øª ØµØ¯Ù…Ø©..."></textarea>
            </div>
            <button id="checkBurnoutBtn" class="btn-full">ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ø§Ø³ØªØ¯Ø§Ù…Ø© Ø§Ù„Ù…Ù‡Ù†ÙŠØ© âš¡</button>
        </div>

        <div id="statusLog" style="text-align:center; margin-bottom:20px; font-weight:bold;"></div>

        <div id="resultArea" class="result-card">
            <div id="burnoutContent"></div>
            <button id="exportBtn" class="btn btn-ghost" style="margin-top:20px; width:100%; border:1px solid #ddd;">ğŸ“¥
                ØªØ­Ù…ÙŠÙ„ ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø§Ø³ØªØ¯Ø§Ù…Ø© Ø§Ù„Ø´Ø®ØµÙŠ</button>
        </div>
    </div>

    <script>
        const BRIDGE_URL = "https://script.google.com/macros/s/AKfycbzCic7XWHobosbwc4PR7_zoS1aZqO6u2UO2-C5Sjm1Nrk7S_iKiCekYa-2Mz84tz-RC/exec";

        document.getElementById('checkBurnoutBtn').onclick = async () => {
            const nature = document.getElementById('jobNature').value;
            const env = document.getElementById('workEnv').value;

            const btn = document.getElementById('checkBurnoutBtn');
            const status = document.getElementById('statusLog');
            btn.disabled = true;
            status.innerText = "â³ Ø¬Ø§Ø±ÙŠ ØªÙ‚Ù„ÙŠÙ„ Ø¶ØºØ· Ø§Ù„Ø¹Ù…Ù„... ÙˆØªØ­Ù„ÙŠÙ„ Ù…Ø¤Ø´Ø±Ø§Øª Ø§Ù„Ø§Ø­ØªØ±Ø§Ù‚...";

            const prompt = `
            Ø£Ù†Øª Ù…Ø³ØªØ´Ø§Ø± Ù…ÙˆØ§Ø±Ø¯ Ø¨Ø´Ø±ÙŠØ© Ù…Ø®ØªØµ Ø¨Ø§Ù„ØµØ­Ø© Ø§Ù„Ù†ÙØ³ÙŠØ© ÙˆØ§Ù„Ø§Ø³ØªØ¯Ø§Ù…Ø© ÙÙŠ Ø§Ù„Ù…Ù†Ø¸Ù…Ø§Øª.
            Ø§Ù„Ù…Ø¯Ø®Ù„Ø§Øª: Ø§Ù„ÙˆØ¸ÙŠÙØ© ${nature}, Ø§Ù„Ø¨ÙŠØ¦Ø© ${env}.
            
            Ø§Ù„Ù…Ø·Ù„ÙˆØ¨ (JSON Ø­ØµØ±Ø§Ù‹):
            {
                "burnout_risk": "Low|Medium|High",
                "risk_ar": "Ù…Ù†Ø®ÙØ¶|Ù…ØªÙˆØ³Ø·|Ø¹Ø§Ù„ÙŠ",
                "markers": ["Ù…Ø¤Ø´Ø± Ø®ÙÙŠ 1", "Ù…Ø¤Ø´Ø± 2"],
                "analysis": "ØªØ­Ù„ÙŠÙ„ ÙˆØ§Ù‚Ø¹ÙŠ Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø¶ØºØ· ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„Ø¯ÙˆØ±",
                "survival_tips": ["Ù†ØµÙŠØ­Ø© Ù„Ù„Ø¨Ù‚Ø§Ø¡ 1", "Ù†ØµÙŠØ­Ø© 2"],
                "long_term_plan": "Ø®Ø·Ø© Ù„Ù„Ø§Ø³ØªÙ…Ø±Ø§Ø± Ù„Ø³Ù†ÙˆØ§Øª Ø¯ÙˆÙ† Ø§Ø­ØªØ±Ø§Ù‚",
                "wellness_tools": ["Ø£Ø¯Ø§Ø© 1", "ØªØ·Ø¨ÙŠÙ‚ 2"]
            }
            Ø¨Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©.
            `;

            try {
                const res = await fetch(BRIDGE_URL + "?action=ai", {
                    method: "POST",
                    headers: { "Content-Type": "text/plain;charset=utf-8" },
                    body: JSON.stringify({
                        model: "llama-3.3-70b-versatile",
                        messages: [{ role: "user", content: prompt }],
                        temperature: 0.7
                    })
                });

                const dataText = await res.text();
                const json = JSON.parse(dataText.match(/\{[\s\S]*\}/)[0]);

                let riskColor = json.burnout_risk === 'High' ? '#ef4444' : (json.burnout_risk === 'Medium' ? '#f59e0b' : '#10b981');

                let html = `
                    <div class="burnout-indicator" style="border-right-color:${riskColor};">
                        <h2 style="color:${riskColor}; margin:0;">Ù…Ø³ØªÙˆÙ‰ Ø®Ø·Ø± Ø§Ù„Ø§Ø­ØªØ±Ø§Ù‚: ${json.risk_ar}</h2>
                        <p style="margin-top:10px;">${json.analysis}</p>
                    </div>

                    <h3 style="color:var(--primary); border-bottom:1px solid #ddd; padding-bottom:5px;">ğŸš© Ù…Ø¤Ø´Ø±Ø§Øª ÙŠØ¬Ø¨ Ø§Ù„Ø§Ù†ØªØ¨Ø§Ù‡ Ù„Ù‡Ø§</h3>
                    <ul>${json.markers.map(m => `<li>${m}</li>`).join('')}</ul>

                    <h3 style="color:#10b981; margin-top:20px;">ğŸ›¡ï¸ Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ§Øª ÙˆÙ‚Ø§Ø¦ÙŠØ© ÙÙˆØ±ÙŠØ©</h3>
                    <ul>${json.survival_tips.map(t => `<li>${t}</li>`).join('')}</ul>

                    <div style="background:#f0fdf4; padding:20px; border-radius:12px; margin-top:20px;">
                        <h3 style="color:#065f46; margin-top:0;">ğŸ“… Ø®Ø·Ø© Ø§Ù„Ø§Ø³ØªØ¯Ø§Ù…Ø© Ø·ÙˆÙŠÙ„Ø© Ø§Ù„Ø£Ù…Ø¯</h3>
                        <p>${json.long_term_plan}</p>
                    </div>

                    <p style="margin-top:20px;"><strong>ğŸ› ï¸ Ø£Ø¯ÙˆØ§Øª Ù…Ù‚ØªØ±Ø­Ø© Ù„Ù„ØµØ­Ø© Ø§Ù„Ù…Ù‡Ù†ÙŠØ©:</strong> ${json.wellness_tools.join(' - ')}</p>
                `;

                document.getElementById('burnoutContent').innerHTML = html;
                document.getElementById('resultArea').style.display = 'block';
                status.innerText = "âœ… Ø§ÙƒØªÙ…Ù„ ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø§Ø³ØªØ¯Ø§Ù…Ø©!";
            } catch (e) {
                console.error(e);
                status.innerText = "âŒ ÙØ´Ù„ Ø§Ù„Ø§ØªØµØ§Ù„.";
            } finally {
                btn.disabled = false;
            }
        };
        document.getElementById('exportBtn').onclick = () => {
            ProtectionManager.verify(() => window.print());
        };
    </script>
</body>

</html>